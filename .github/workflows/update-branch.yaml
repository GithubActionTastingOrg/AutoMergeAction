name: Update branch

on:
    push:
        branches:
            - main
    pull_request:
        types:
            - labeled
    check_suite:
        types:
            - completed

    # Allows you to run this workflow manually from the Actions tab
    workflow_dispatch:

jobs:
    update-branch:
        runs-on: ubuntu-latest
        steps:
            - uses: lcdsmao/update-branch@v3
              with:
                  # Or use personal access token
                  token: ${{ secrets.GITHUB_TOKEN }}
                  # One of MERGE, SQUASH, REBASE (default: MERGE)
                  autoMergeMethod: SQUASH
                  # Ignore pull requests without these labels
                  requiredLabels: auto-merge
                  # Required at least 2 approves (default: 0)
                  requiredApprovals: 2
                  # Required approvals from all requested reviewers
                  allRequestedReviewersMustApprove: true
                  # Required these status checks success
                  requiredStatusChecks: |
                      build_pr
                      WIP
